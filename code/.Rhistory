filter(t/300 > i-1,
t/300 < 20 - j,
date == unique(pumpfinal$date)[k])
r2mod[[i]][[j]][[k]] <- lm(data = tempdata, formula = log(mvc) ~ t)
r2val[[i]][[j]][[k]] <- summary(r2mod[[i]][[j]][[k]])$r.squared
}
names(r2mod[[i]][[j]]) <- unique(pumpfinal$date)
names(r2val[[i]][[j]]) <- unique(pumpfinal$date)
}
names(r2mod[[i]]) <- paste0('stop', 1:n_stop)
names(r2val[[i]]) <- paste0('stop', 1:n_stop)
}
names(r2mod) <- paste0('start', 1:n_start)
names(r2val) <- paste0('start', 1:n_start)
r2final <- tibble(unlist(r2val), names(unlist(r2val))) %>% #requires single digit start and stop
mutate(r2 = .[[1]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,))
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = stop, color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = min_r2, group = stop, color = stop, label = round(min_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
ggplot(aes(x = start, y = r2, group = date, color = stop, label = round(r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = factor(stop), color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
ggplot(aes(x = start, y = r2, group = date, group = stop, color = stop, label = round(r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
ggplot(aes(x = start, y = r2, group = date, color = date, label = round(r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
ggplot(aes(x = start, y = r2, label = round(r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
ggplot(aes(x = start, y = r2, label = round(r2,3))) +
geom_boxplot() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1)
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3))) +
geom_boxplot() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = stop, color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = min_r2, group = stop, color = stop, label = round(min_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3))) +
geom_boxplot() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = stop, color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = min_r2, group = stop, color = stop, label = round(min_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3))) +
geom_boxplot() +
scale_color_viridis_d()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3))) +
geom_boxplot() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = stop, color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = min_r2, group = stop, color = stop, label = round(min_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), color = factor(date))) +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = mean_r2, group = stop, color = stop, label = round(mean_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = min_r2, group = stop, color = stop, label = round(min_r2,3))) +
geom_point() +
geom_line() +
scale_color_viridis_d()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_color_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_color_viridis_c()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
pumpfinal %>%
group_by(date) %>%
summarize(n = n(),
stop_step = max(t)/300) # start always 1
n_start = 8
n_stop = 8
r2mod = list()
r2val = list()
for (i in 1:n_start) {
r2mod[[i]] <- list()
r2val[[i]] <- list()
for (j in 1:n_stop) {
r2mod[[i]][[j]] <- list()
r2val[[i]][[j]] <- list()
for (k in 1:length(unique(pumpfinal$date))) {
tempdata <- pumpfinal %>%
filter(t/300 > i-1,
t/300 < 20 - j,
date == unique(pumpfinal$date)[k])
r2mod[[i]][[j]][[k]] <- lm(data = tempdata, formula = log(mvc) ~ t)
r2val[[i]][[j]][[k]] <- summary(r2mod[[i]][[j]][[k]])$r.squared
}
names(r2mod[[i]][[j]]) <- unique(pumpfinal$date)
names(r2val[[i]][[j]]) <- unique(pumpfinal$date)
}
names(r2mod[[i]]) <- paste0('stop', 1:n_stop)
names(r2val[[i]]) <- paste0('stop', 1:n_stop)
}
names(r2mod) <- paste0('start', 1:n_start)
names(r2val) <- paste0('start', 1:n_start)
r2final <- tibble(unlist(r2val), names(unlist(r2val))) %>% #requires single digit start and stop
mutate(r2 = .[[1]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,))
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
coef(r2mod[[1]][[1]][[1]])
coef(r2mod[[1]][[1]][[1]])[2]
-coef(r2mod[[1]][[1]][[1]])[2]
pumpfinal %>%
group_by(date) %>%
summarize(n = n(),
stop_step = max(t)/300) # start always 1
n_start = 8
n_stop = 8
r2mod <- list()
r2val <- list()
ktval <- list()
for (i in 1:n_start) {
r2mod[[i]] <- list()
r2val[[i]] <- list()
ktval[[i]] <- list()
for (j in 1:n_stop) {
r2mod[[i]][[j]] <- list()
r2val[[i]][[j]] <- list()
ktval[[i]][[j]] <- list()
for (k in 1:length(unique(pumpfinal$date))) {
tempdata <- pumpfinal %>%
filter(t/300 > i-1,
t/300 < 20 - j,
date == unique(pumpfinal$date)[k])
r2mod[[i]][[j]][[k]] <- lm(data = tempdata, formula = log(mvc) ~ t)
r2val[[i]][[j]][[k]] <- summary(r2mod[[i]][[j]][[k]])$r.squared
ktval[[i]][[j]][[k]] <- -coef(r2mod[[1]][[1]][[1]])[2]
}
names(r2mod[[i]][[j]]) <- unique(pumpfinal$date)
names(r2val[[i]][[j]]) <- unique(pumpfinal$date)
names(ktval[[i]][[j]]) <- unique(pumpfinal$date)
}
names(r2mod[[i]]) <- paste0('stop', 1:n_stop)
names(r2val[[i]]) <- paste0('stop', 1:n_stop)
names(ktval[[i]]) <- paste0('stop', 1:n_stop)
}
names(r2mod) <- paste0('start', 1:n_start)
names(r2val) <- paste0('start', 1:n_start)
names(ktval) <- paste0('start', 1:n_start)
r2final <- tibble(unlist(r2val), names(unlist(r2val)), unlist(ktval)) %>% #requires single digit start and stop
mutate(r2 = .[[1]],
kt = .[[3]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,))
r2final <- tibble(unlist(r2val), names(unlist(r2val)), unlist(ktval)) %>% #requires single digit start and stop
transmute(r2 = .[[1]],
kt = .[[3]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,))
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
ktfinal %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = kt, label = round(kt,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = kt, label = round(kt,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = kt, label = round(kt,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
View(r2final)
pumpfinal %>%
group_by(date) %>%
summarize(n = n(),
stop_step = max(t)/300) # start always 1
n_start = 8
n_stop = 8
r2mod <- list()
r2val <- list()
ktval <- list()
for (i in 1:n_start) {
r2mod[[i]] <- list()
r2val[[i]] <- list()
ktval[[i]] <- list()
for (j in 1:n_stop) {
r2mod[[i]][[j]] <- list()
r2val[[i]][[j]] <- list()
ktval[[i]][[j]] <- list()
for (k in 1:length(unique(pumpfinal$date))) {
tempdata <- pumpfinal %>%
filter(t/300 > i-1,
t/300 < 20 - j,
date == unique(pumpfinal$date)[k])
r2mod[[i]][[j]][[k]] <- lm(data = tempdata, formula = log(mvc) ~ t)
r2val[[i]][[j]][[k]] <- summary(r2mod[[i]][[j]][[k]])$r.squared
ktval[[i]][[j]][[k]] <- -coef(r2mod[[i]][[j]][[k]])[2]
}
names(r2mod[[i]][[j]]) <- unique(pumpfinal$date)
names(r2val[[i]][[j]]) <- unique(pumpfinal$date)
names(ktval[[i]][[j]]) <- unique(pumpfinal$date)
}
names(r2mod[[i]]) <- paste0('stop', 1:n_stop)
names(r2val[[i]]) <- paste0('stop', 1:n_stop)
names(ktval[[i]]) <- paste0('stop', 1:n_stop)
}
names(r2mod) <- paste0('start', 1:n_start)
names(r2val) <- paste0('start', 1:n_start)
names(ktval) <- paste0('start', 1:n_start)
r2final <- tibble(unlist(r2val), names(unlist(r2val)), unlist(ktval)) %>% #requires single digit start and stop
transmute(r2 = .[[1]],
kt = .[[3]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,))
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = kt, label = round(kt,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = kt, label = round(kt,3), group = date, color = factor(date))) +
geom_line()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final <- tibble(unlist(r2val), names(unlist(r2val)), unlist(ktval)) %>% #requires single digit start and stop
transmute(r2 = .[[1]],
kt = .[[3]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = str_sub(.[[2]], 14,)) %>%
left_join(metadata, by = "date")
r2final <- tibble(unlist(r2val), names(unlist(r2val)), unlist(ktval)) %>% #requires single digit start and stop
transmute(r2 = .[[1]],
kt = .[[3]],
start = str_sub(.[[2]], 6,6),
stop = str_sub(.[[2]], 12,12),
date = as.numeric(str_sub(.[[2]], 14,))) %>%
left_join(metadata, by = "date")
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), color = dowel_density, lty = pump_freq)) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), color = dowel_density, lty = as.character(pump_freq))) +
geom_line()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = paste0(dowel_density,pump_freq), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = r2, label = round(r2,3), group = paste0(dowel_density,pump_freq), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = r2, label = round(r2,3), group = paste0(dowel_density,pump_freq), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
filter(stop == 1) %>%
ggplot(aes(x = start, y = kt, label = round(r2,3), group = paste0(dowel_density,pump_freq), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
filter(start == 1) %>%
ggplot(aes(x = stop, y = kt, label = round(r2,3), group = paste0(dowel_density,pump_freq), color = dowel_density, lty = as.character(pump_freq))) +
geom_line() +
geom_point()
r2final %>%
group_by(start, stop) %>%
summarise(mean_r2 = mean(r2)) %>%
ggplot(aes(x = start, y = stop, fill = mean_r2, label = round(mean_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
r2final %>%
group_by(start, stop) %>%
summarise(min_r2 = min(r2)) %>%
ggplot(aes(x = start, y = stop, fill = min_r2, label = round(min_r2,3))) +
geom_tile() +
geom_text() +
scale_fill_viridis_c()
