filter(dowel_density != "0000") %>%
ggplot(aes(x = Re, y = k_c, ymin = k_c - dk_c, ymax = k_c + dk_c, color = as.character(round(ad,5)))) +
geom_line(lty = "dotted", size = 2, alpha = .3) +
geom_point(position = position_dodge(width = 10)) +
geom_errorbar(width = 10, position = "dodge") +
scale_color_manual(values = c("blue","green","red")) +
scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +
labs(y = expression(paste(italic(k[c])," (",s^{-1},")")), x = expression(Re[c]), color = expression(italic(ad))) +
theme_minimal()
#temp in flume measured at 22.2C with a calibrated thermometer
#plugged into https://www.engineeringtoolbox.com/water-dynamic-kinematic-viscosity-d_596.html
visc = 9.509e-7 #kinematic viscosity, m2/s
d = .003175 #dowel diameter
final <- final %>%
mutate(frontal_area = as.numeric(dowel_density)*.003175,
u = as.numeric(pump_freq)/500, #velocity
Re = u*.003175/visc, #Reynolds #
k_t = -t,
k_c, k_s, k_bg) %>%
mutate(eta = k_c/u/frontal_area,
deta = dk_c/u/frontal_area) %>%
mutate(eta = eta * 2.43/(1.95*.4*.6),
deta = deta * 2.43/(1.95*.4*.6)) # don't forget to correct for time out of test section!
final %>%
filter(dowel_density != "0000") %>%
mutate(Refac = factor(Re, labels = c("Re = 66.78", "Re = 133.56", "Re = 200.34"))) %>%
ggplot(aes(x = ad, y = eta, ymin = eta - deta, ymax = eta + deta, color = as.character(round(ad,5)))) +
geom_line(lty = "dotted", size = 2, alpha = .3) +
geom_point() +
geom_errorbar() +
scale_color_manual(values = c("blue","green","red")) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~Refac) +
labs(y = "Effective capture efficiency", x = expression(italic(ad)), color = expression(italic(ad))) +
theme_bw()
final <- final %>%
mutate(frontal = ad/.003175, phi = ad*pi/4)
final %>%
select(dowel_density, frontal, ad, phi) %>%
distinct() %>%
arrange(ad) %>%
filter(ad>0)
cmods <- final %>%
mutate(coeff = 0.04312975*Re^-1.14) %>%
lmList(eta ~ 0 + coeff|phi, data = .)
c_over_phi <- cbind(rownames(coef(cmods))[2:4],coef(cmods)[2:4,]) %>%
as.tibble() %>%
mutate_all(as.numeric) %>%
mutate(lab = "ESDL") %>%
rename(phi = V1, C = V2)
fauria <- tibble(phi = c(.00817,.02163), C = c(3.18,1.53), lab = "Fauria")
c_over_phi <- rbind(c_over_phi, fauria)
c_over_phi %>%
ggplot(aes(x = phi, y = C, color = lab)) +
geom_point() +
theme_bw() +
labs(title = "Comparison of power-law constant to Fauria et al. data",
x = expression(phi))
# curve data
fauria_pred <- tibble(Re = rep(seq(66,200,length = 1000),3),
C = c(rep(46.46556,1000),rep(10.987587,1000),rep(8.983344,1000)),
phi = c(rep(0.002257447,1000),rep(0.006496250,1000),rep(0.011774453,1000))) %>%
mutate(eta_est = Re^-1.14*C*0.04312975, ad = phi)
final %>%
filter(dowel_density != "0000") %>%
mutate(Refac = factor(Re, labels = c("Re = 66.78", "Re = 133.56", "Re = 200.34"))) %>%
ggplot(aes(x = Re, y = eta, ymin = eta - deta, ymax = eta + deta, color = as.character(round(phi,5)))) +
geom_point() +
geom_errorbar() +
geom_line(data = fauria_pred, aes(y = eta_est, x = Re), inherit.aes = FALSE) +
scale_color_manual(values = c("blue","green","red")) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ as.character(round(phi,5))) +
labs(y = "Effective capture efficiency", x = expression(Re), color = expression(phi)) +
theme_bw() +
ggtitle("Comparison of experiments and power-law model based on experiments")
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(10000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi,rep(1:10000,9)) %>%
lmList(eta ~ Re|ID, data = .)
mutate(ID = paste0(phi,rep(1:10000,9))
lms <- bind_rows(monte) %>%
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi,rep(1:10000,9))) %>%
lmList(eta ~ Re|ID, data = .)
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(100, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi,rep(1:100,9))) %>%
lmList(eta ~ Re|ID, data = .)
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi,rep(1:100,9))) %>%
lmList(eta ~ Re|ID, data = ., warn = FALSE)
View(monte)
bind_rows(monte)
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:reps,9)))
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:reps,9)))
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:100,9)))
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:100,9)),
logeta = log(eta))
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:100,9)),
logeta = log(eta)) %>%
group_by(ID)
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:100,9)),
logeta = log(eta)) %>%
group_by(ID) %>%
group_map(function(x) lm(logeta ~ Re))
bind_rows(monte) %>%
mutate(ID = paste0(phi, rep(1:100,9)),
logeta = log(eta)) %>%
group_by(ID) %>%
group_map(function(logeta, Re) lm(logeta ~ Re))
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
reps = 100
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(100, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
bind_rows(monte)
bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100))
bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients() %>%
rownames()
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
View(lms)
rownames(lms)
cbind(rownames(lms),lms)
tibble(phi = str_sub(rownames(lms),,6),lms)
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(100, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
lms <- tibble(phi = str_sub(rownames(lms),,6),lms)
lms <- tibble(phi = str_sub(rownames(lms),0,6),lms)
lms2 <- tibble(phi = str_sub(rownames(lms),0,6),lms)
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(100, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:100)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
lms2 <- tibble(phi = str_sub(rownames(lms),0,6),lms)
lms2
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:1000)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
lms2 <- tibble(phi = str_sub(rownames(lms),0,6),lms)
lms2
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re), sd = sd(Re))
lms2
lms2 %>%
ggplot(aes(x = phi, y = Re)) +
geom_jitter()
lms2 %>%
ggplot(aes(x = phi, y = Re)) +
geom_violin()
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re), sd = sd(Re))
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re))
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE))
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar()
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw()
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = .0022, y = 0, lab = "*"))
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = .0022, y = 0, label = "*"))
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = .0022, y = 0, label = "*"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = .0022, y = 0, label = "ASDFA"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = .022, y = 0, label = "ASDFA"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = ".0022", y = 0, label = "ASDFA"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = 0, label = "ASDFA"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = 0, label = "*"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .0001, label = "*"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .0005, label = "*"), size = 4)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .0005, label = "*"), size = 8)
monte2 <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms3 <- bind_rows(monte) %>%
mutate(ID = paste0(Re, 1:1000)) %>%
lmList(log(eta) ~ phi|ID, data = .) %>%
coefficients()
lms4 <- tibble(phi = str_sub(rownames(lms3),0,6),lms3)
monte2 <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms3 <- bind_rows(monte) %>%
mutate(ID = paste0(Re, 1:1000)) %>%
lmList(log(eta) ~ phi|ID, data = .) %>%
coefficients()
monte2 <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms3 <- bind_rows(monte) %>%
mutate(ID = paste0(Re, 1:1000)) %>%
lmList(log(eta) ~ phi|ID, data = .) %>%
coefficients()
lms4 <- tibble(Re = str_sub(rownames(lms3),0,-1),lms3)
lms4 %>%
group_by(Re) %>%
summarise(avg = mean(phi, na.rm = TRUE), sd = sd(phi, na.rm = TRUE)) %>%
ggplot(aes(x = Re, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() #+
#geom_text(aes(x = "0.0022", y = .0005, label = "*"), size = 8)
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:1000)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
lms2 <- tibble(phi = str_sub(rownames(lms),0,6),lms)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .0005, label = "*"), size = 8)
monte2 <- list()
for (i in 1:nrow(skeleton_eta)) {
monte2[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lms3 <- bind_rows(monte2) %>%
mutate(ID = paste0(Re, 1:1000)) %>%
lmList(log(eta) ~ phi|ID, data = .) %>%
coefficients()
lms4 <- tibble(Re = str_sub(rownames(lms3),0,-1),lms3)
lms4 %>%
group_by(Re) %>%
summarise(avg = mean(phi, na.rm = TRUE), sd = sd(phi, na.rm = TRUE)) %>%
ggplot(aes(x = Re, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() #+
#geom_text(aes(x = "0.0022", y = .0005, label = "*"), size = 8)
View(lms3)
View(lms4)
View(lms3)
lms4 <- tibble(Re = str_sub(rownames(lms3),0,6),lms3)
lms4 %>%
group_by(Re) %>%
summarise(avg = mean(phi, na.rm = TRUE), sd = sd(phi, na.rm = TRUE)) %>%
ggplot(aes(x = Re, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() #+
geom_text(aes(x = "200.33", y = .0005, label = "*"), size = 8)
lms4 %>%
group_by(Re) %>%
summarise(avg = mean(phi, na.rm = TRUE), sd = sd(phi, na.rm = TRUE)) %>%
ggplot(aes(x = Re, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "200.33", y = .0005, label = "*"), size = 8)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = avg+2.2*sd, label = "*"), size = 8)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .003, label = "*"), size = 8)
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE))
-.010649536+1.96*.005309518
lms2 %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
mutate(ymax = avg + 1.96*sd)
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lmphi <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:1000)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
skeleton_eta <- final %>%
filter(frontal_area > 0) %>%
select(phi, Re, eta, deta) %>%
arrange(phi, Re)
monte <- list()
for (i in 1:nrow(skeleton_eta)) {
monte[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(1000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lmsphi <- bind_rows(monte) %>%
mutate(ID = paste0(phi, 1:1000)) %>%
lmList(log(eta) ~ Re|ID, data = .) %>%
coefficients()
lmsphi <- tibble(phi = str_sub(rownames(lmsphi),0,6),lmsphi)
lmsphi <- lmsphi %>%
group_by(phi) %>%
summarise(avg = mean(Re, na.rm = TRUE), sd = sd(Re, na.rm = TRUE)) %>%
mutate(ymax = avg + 1.96*sd)
lmsphi
lmsphi %>%
ggplot(aes(x = phi, y = avg, ymin = avg-1.96*sd, ymax = avg+1.96*sd)) +
geom_point() +
geom_errorbar() +
theme_bw() +
geom_text(aes(x = "0.0022", y = .003, label = "*"), size = 8)
monte2 <- list()
for (i in 1:nrow(skeleton_eta)) {
monte2[[i]] <- tibble(phi = skeleton_eta$phi[i],
Re = skeleton_eta$Re[i],
eta = rnorm(5000, mean = skeleton_eta$eta[i], sd = skeleton_eta$deta[i]))
}
lmsre <- bind_rows(monte2) %>%
mutate(ID = paste0(Re, 1:5000)) %>%
lmList(log(eta) ~ phi|ID, data = .) %>%
coefficients()
lmsre <- tibble(Re = str_sub(rownames(lmsre),0,6),lmsre)
